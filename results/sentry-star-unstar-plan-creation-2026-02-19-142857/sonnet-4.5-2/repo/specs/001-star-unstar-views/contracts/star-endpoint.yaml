openapi: 3.0.3
info:
  title: GroupSearchView Star API
  version: 1.0.0
  description: API endpoint for starring GroupSearchViews with optional position management

paths:
  /api/0/organizations/{organization_id_or_slug}/group-search-views/{view_id}/star/:
    post:
      summary: Star a GroupSearchView
      description: |
        Stars (bookmarks) a shared issue view for quick access. The view will be added to the user's 
        personal list of starred views. 

        - If `position` is not specified, the view is appended to the end of the starred list
        - If `position` is specified, the view is inserted at that position and subsequent views are shifted down
        - This operation is idempotent - starring an already-starred view succeeds without changes

      operationId: starGroupSearchView
      tags:
        - GroupSearchViews

      parameters:
        - name: organization_id_or_slug
          in: path
          required: true
          description: Organization ID or slug
          schema:
            type: string
          example: 'my-organization'

        - name: view_id
          in: path
          required: true
          description: Numeric ID of the GroupSearchView to star
          schema:
            type: integer
            format: int64
          example: 12345

      requestBody:
        description: Optional position parameter for ordering starred views
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                position:
                  type: integer
                  minimum: 1
                  description: |
                    Position in the starred views list (1-indexed). 
                    If omitted, view is appended to the end.
                    If specified, existing views at this position and higher are shifted down.
                  example: 2
            examples:
              appendToEnd:
                summary: Append to end of list
                value: {}

              insertAtPosition:
                summary: Insert at specific position
                value:
                  position: 2

      responses:
        '204':
          description: |
            View successfully starred (or already starred - idempotent).
            No response body.

        '400':
          description: Invalid request (e.g., position is not a positive integer)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                detail: 'Position must be a positive integer'

        '401':
          description: Unauthorized - authentication required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                detail: 'Authentication credentials were not provided'

        '404':
          description: |
            View not found or user does not have access.
            Same response for both cases to avoid leaking view existence.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                detail: 'View not found'

        '409':
          description: |
            Conflict - concurrent position update (rare edge case).
            Client should retry.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              example:
                detail: 'Position conflict, please retry'

      security:
        - bearerAuth: []
        - cookieAuth: []

components:
  schemas:
    ErrorResponse:
      type: object
      required:
        - detail
      properties:
        detail:
          type: string
          description: Human-readable error message
      description: |
        Standard DRF error response format.
        All Sentry API errors use the "detail" key.

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      description: API token authentication

    cookieAuth:
      type: apiKey
      in: cookie
      name: sessionid
      description: Session cookie authentication
